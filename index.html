<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PV + Energy Storage Environmental Impact Assessment Tool</title>
    <!-- Import ECharts visualization library -->
    <script src="https://cdn.jsdelivr.net/npm/echarts/dist/echarts.min.js"></script>
    <!-- Import Axios library for front-back end communication -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <!-- Simple styling for the page -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Arial", sans-serif;
        }
        .container {
            width: 90%;
            max-width: 800px;
            margin: 30px auto;
            padding: 20px;
            border: 1px solid #eee;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        h2 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
        }
        .input-area {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        .input-area label {
            font-size: 16px;
            color: #666;
        }
        .input-area select {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        .input-area button {
            padding: 8px 20px;
            background-color: #409eff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        .input-area button:hover {
            background-color: #66b1ff;
        }
        .result-area {
            margin: 30px 0;
            padding: 20px;
            background-color: #f5f7fa;
            border-radius: 5px;
        }
        .result-area p {
            font-size: 18px;
            line-height: 2;
            color: #333;
        }
        #chart {
            width: 100%;
            height: 350px;
            margin-top: 30px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>PV + Energy Storage System Environmental Impact Assessment Tool</h2>
        <!-- Parameter input area -->
        <div class="input-area">
            <label>PV Installed Capacity (kW)：</label>
            <select id="pvCap">
                <option value="1">1</option>
                <option value="3">3</option>
                <option value="5" selected>5</option>
                <option value="10">10</option>
            </select>

            <label>Service Life (Years)：</label>
            <select id="years">
                <option value="10">10</option>
                <option value="20" selected>20</option>
                <option value="25">25</option>
            </select>

            <button onclick="calculate()">Start Environmental Assessment</button>
        </div>

        <!-- Result display area -->
        <div class="result-area">
            <p>Annual Power Generation：<span id="power">0</span> Megawatt-hour (MWh)</p >
            <p>Annual CO2 Reduction：<span id="co2">0</span> Tons</p >
            <p>Annual Fossil Energy Replacement：<span id="coal">0</span> Tons of Standard Coal</p >
        </div>

        <!-- Visualization chart area -->
        <div id="chart"></div>
    </div>

    <script>
        // Initialize ECharts chart
        var myChart = echarts.init(document.getElementById('chart'));
        // Set default chart style
        myChart.setOption({
            title: {text: 'PV System Environmental Benefit Analysis', left: 'center'},
            xAxis: {type: 'category', data: ['Annual Power Generation', 'CO2 Reduction', 'Fossil Energy Replacement']},
            yAxis: {type: 'value'},
            series: [{name: 'Value', type: 'bar', data: [0, 0, 0]}]
        });

        // Define calculation function after button click
        function calculate() {
            // Get parameters selected by the user
            var pvCap = document.getElementById('pvCap').value;
            var years = document.getElementById('years').value;

            // Call back-end interface to get calculation results
            axios.post('https://PEIYIFEI123githubio-1.yifeipei24.repl.co/calculate', {
                pv_cap: pvCap,
                years: years
            }).then(function (response) {
                // Display results returned by the back end on the page
                var res = response.data;
                document.getElementById('power').innerText = res.annual_power;
                document.getElementById('co2').innerText = res.co2_reduction;
                document.getElementById('coal').innerText = res.coal_replacement;

                // Update chart data
                myChart.setOption({
                    series: [{data: [res.annual_power, res.co2_reduction, res.coal_replacement]}]
                });
            }).catch(function (error) {
                // Pop up a prompt if an error occurs
                alert('Calculation failed! Please check if the back end is running.');
                console.log(error);
            });
        }
    </script>
</body>

</html>


